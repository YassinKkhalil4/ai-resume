"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[727],{4727:function(e,t,a){a.r(t),a.d(t,{default:function(){return r}});var n=a(7437),i=a(2265);function r(e){let{onText:t}=e,[r,l]=(0,i.useState)(!1),[s,d]=(0,i.useState)(null);async function o(e){l(!0),d(null);try{if(!(e.type.includes("pdf")||e.name.toLowerCase().endsWith(".pdf")))throw Error("OCR is only for scanned PDFs");let n=(await a.e(728).then(a.t.bind(a,7728,23))).default||await a.e(728).then(a.t.bind(a,7728,23)),i=await e.arrayBuffer(),{getPdfJs:r}=await Promise.all([a.e(83),a.e(246)]).then(a.bind(a,3246)),l=await r(),s=await l.getDocument({data:i}).promise,d=await s.getPage(1),o=d.getViewport({scale:1.5}),c=document.createElement("canvas"),u=c.getContext("2d");c.width=o.width,c.height=o.height,await d.render({canvasContext:u,viewport:o}).promise;let h=c.toDataURL("image/png"),{data:{text:f}}=await n.recognize(h,"eng");if(!f||f.trim().length<30)throw Error("OCR produced too little text");t(f)}catch(e){d((null==e?void 0:e.message)||"OCR failed")}finally{l(!1)}}return(0,n.jsxs)("div",{className:"mt-3 p-3 border rounded bg-yellow-50 text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,n.jsx)("div",{children:"Scanned PDF? Try OCR (experimental). Extracts text from the first page only."}),(0,n.jsxs)("label",{className:"button-outline cursor-pointer",children:[r?"Running OCRâ€¦":"Run OCR",(0,n.jsx)("input",{type:"file",accept:"application/pdf",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&o(a)},hidden:!0})]})]}),s&&(0,n.jsx)("div",{className:"text-red-600 mt-2",children:s})]})}}}]);