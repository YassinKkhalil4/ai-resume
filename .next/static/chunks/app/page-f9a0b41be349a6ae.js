(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4033:function(e,s,t){Promise.resolve().then(t.bind(t,876))},876:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return E}});var n=t(7437),l=t(2265),i=t(551);function a(e){let{value:s,onChange:t}=e,[i,a]=(0,l.useState)(""),[c,o]=(0,l.useState)(!1);async function r(){if(i){o(!0);try{let e=await fetch("/api/tailor",{method:"POST",body:(()=>{let e=new FormData;return e.append("jd_url",i),e.append("mode","fetchOnly"),e})()}),s=await e.json();e.ok&&(null==s?void 0:s.jd_text)?t(s.jd_text):alert((null==s?void 0:s.error)||"Could not fetch that URL. Paste text instead.")}catch(e){alert((null==e?void 0:e.message)||"Failed to fetch URL.")}finally{o(!1)}}}return(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)("textarea",{className:"input h-40",placeholder:"Paste the job description here…",value:s,onChange:e=>t(e.target.value)}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("input",{className:"input",placeholder:"…or paste a job URL",value:i,onChange:e=>a(e.target.value)}),(0,n.jsx)("button",{className:"button-outline",onClick:r,disabled:c,children:c?"Fetching…":"Fetch URL"})]})]})}function c(e,s){var t,n;return'<!doctype html>\n<html><head><meta charset="utf-8" /><style>\n  /* Force safe system fonts to avoid blank glyphs in serverless Chromium */\n  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, "Helvetica Neue", Helvetica, sans-serif; color:#111; font-size: 11.5pt; line-height: 1.35; }\n  h2 { font-size: 12.5pt; margin: 0 0 6px; letter-spacing: 0.2px; }\n  .sec { margin: 16px 0; }\n  .role { font-weight: 600; }\n  ul { margin: 4px 0 0 16px; padding: 0; }\n  li { margin: 2px 0; }\n  .sep { height:1px; background:#eaeaea; margin:10px 0; }\n</style></head><body>\n  '.concat(s.includeSummary&&e.summary?'<div class="sec"><h2>Summary</h2><div>'.concat(o(e.summary),"</div></div>"):"",'\n  <div class="sec"><h2>Experience</h2><div class="sep"></div>\n    ').concat(e.experience.map(e=>'\n      <div class="entry">\n        <div class="role">'.concat(o(e.role)," — ").concat(o(e.company),' <span style="color:#666; font-weight:400">(').concat(o(e.dates),")</span></div>\n        <ul>").concat(e.bullets.map(e=>"<li>".concat(o(e),"</li>")).join(""),"</ul>\n      </div>\n    ")).join(""),"\n  </div>\n  ").concat(s.includeSkills&&(null===(t=e.skills)||void 0===t?void 0:t.length)?'<div class="sec"><h2>Skills</h2><div>'.concat((e.skills||[]).join(" • "),"</div></div>"):"","\n  ").concat((null===(n=e.education)||void 0===n?void 0:n.length)?'<div class="sec"><h2>Education</h2><ul>'.concat((e.education||[]).map(e=>"<li>".concat(o(e),"</li>")).join(""),"</ul></div>"):"","\n</body></html>")}function o(e){return e.replace(/[&<>]/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;"})[e])}function r(e,s){var t,n;return'<!doctype html>\n<html><head><meta charset="utf-8" /><style>\n  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, "Helvetica Neue", Helvetica, sans-serif; color:#111; font-size: 12pt; line-height: 1.35; }\n  h2 { font-size: 13pt; margin: 0 0 8px; }\n  .sec { margin: 14px 0; }\n  .row { display:flex; justify-content: space-between; }\n  .role { font-weight: 600; }\n  ul { margin: 6px 0 0 16px; padding: 0; }\n  li { margin: 4px 0; }\n  .chips span { display:inline-block; background:#f5f5f5; border-radius: 6px; padding: 2px 8px; margin: 0 6px 6px 0; font-size: 10pt; }\n  .divider { height:1px; background:#eee; margin:8px 0; }\n</style></head><body>\n  '.concat(s.includeSummary&&e.summary?'<div class="sec"><h2>Summary</h2><div>'.concat(d(e.summary),"</div></div>"):"",'\n  <div class="sec"><h2>Experience</h2><div class="divider"></div>\n    ').concat(e.experience.map(e=>'\n      <div class="entry">\n        <div class="row"><div class="role">'.concat(d(e.role)," — ").concat(d(e.company),'</div><div style="color:#666">').concat(d(e.dates),"</div></div>\n        <ul>").concat(e.bullets.map(e=>"<li>".concat(d(e),"</li>")).join(""),"</ul>\n      </div>\n    ")).join(""),"\n  </div>\n  ").concat(s.includeSkills&&(null===(t=e.skills)||void 0===t?void 0:t.length)?'<div class="sec"><h2>Skills</h2><div class="chips">'.concat((e.skills||[]).map(e=>"<span>".concat(d(e),"</span>")).join(""),"</div></div>"):"","\n  ").concat((null===(n=e.education)||void 0===n?void 0:n.length)?'<div class="sec"><h2>Education</h2><ul>'.concat((e.education||[]).map(e=>"<li>".concat(d(e),"</li>")).join(""),"</ul></div>"):"","\n</body></html>")}function d(e){return e.replace(/[&<>]/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;"})[e])}function u(e,s){var t,n,l;return'<!doctype html>\n<html><head><meta charset="utf-8" /><style>\n  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, "Helvetica Neue", Helvetica, sans-serif; color:#111; font-size: 12pt; line-height: 1.35; }\n  h1,h2 { margin: 0 0 6px; }\n  h2 { font-size: 13pt; border-bottom: 1px solid #ddd; padding-bottom: 4px; }\n  .sec { margin: 14px 0; }\n  .role { font-weight: bold; }\n  ul { margin: 6px 0 0 16px; padding: 0; }\n  li { margin: 4px 0; }\n  .chips span { display:inline-block; border:1px solid #ccc; border-radius: 12px; padding: 2px 8px; margin: 0 6px 6px 0; font-size: 10pt; }\n</style></head><body>\n  '.concat(s.includeSummary&&e.summary?'<div class="sec"><h2>Summary</h2><div>'.concat(m(e.summary),"</div></div>"):"",'\n  <div class="sec"><h2>Experience</h2>\n    ').concat(e.experience.map(e=>'\n      <div class="entry">\n        <div class="role">'.concat(m(e.role)," — ").concat(m(e.company),'</div>\n        <div class="dates" style="color:#666">').concat(m(e.dates),"</div>\n        <ul>").concat(e.bullets.map(e=>"<li>".concat(m(e),"</li>")).join(""),"</ul>\n      </div>\n    ")).join(""),"\n  </div>\n  ").concat(s.includeSkills&&(null===(t=e.skills)||void 0===t?void 0:t.length)?'<div class="sec"><h2>Skills</h2><div class="chips">'.concat((e.skills||[]).map(e=>"<span>".concat(m(e),"</span>")).join(""),"</div></div>"):"","\n  ").concat((null===(n=e.education)||void 0===n?void 0:n.length)?'<div class="sec"><h2>Education</h2><ul>'.concat((e.education||[]).map(e=>"<li>".concat(m(e),"</li>")).join(""),"</ul></div>"):"","\n  ").concat((null===(l=e.certifications)||void 0===l?void 0:l.length)?'<div class="sec"><h2>Certifications</h2><ul>'.concat((e.certifications||[]).map(e=>"<li>".concat(m(e),"</li>")).join(""),"</ul></div>"):"","\n</body></html>")}function m(e){return e.replace(/[&<>]/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;"})[e])}function x(e,s){var t,n,l,i;let a=(null===(t=e.contact)||void 0===t?void 0:t.name)||"",c=(i=e.contact)?[i.email,i.phone,i.location,i.website].filter(Boolean):[];return'<!doctype html><html><head><meta charset="utf-8" /><style>'.concat('\n  body{font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, "Helvetica Neue", Helvetica, sans-serif; color:#0b0b0b; font-size:11.5pt; line-height:1.38;}\n  .wrap{max-width:820px; margin:0 auto;}\n  .hdr{display:grid; grid-template-columns: 2fr 1fr; gap:16px; align-items:flex-end; border-bottom:2px solid #111; padding-bottom:10px; margin-bottom:14px}\n  .name{font-size:20pt; font-weight:700; letter-spacing:.2px}\n  .contact{font-size:10pt; color:#444; text-align:right}\n  h2{font-size:12.8pt; margin:14px 0 6px; letter-spacing:.2px}\n  .sec{margin: 6px 0 10px}\n  .role{font-weight:600}\n  ul{margin:4px 0 0 16px; padding:0}\n  li{margin:2px 0}\n  .meta{color:#666; font-weight:400}\n  ','</style></head><body><div class="wrap">\n  <div class="hdr">\n    <div class="name">').concat(p(a),'</div>\n    <div class="contact">').concat(c.join(" \xb7 "),"</div>\n  </div>\n  ").concat(s.includeSummary&&e.summary?'<div class="sec"><h2>Executive Summary</h2><div>'.concat(p(e.summary),"</div></div>"):"",'\n  <div class="sec"><h2>Experience</h2>\n    ').concat(e.experience.map(e=>'\n      <div class="entry">\n        <div class="role">'.concat(p(e.role)," — ").concat(p(e.company),' <span class="meta">(').concat(p(e.dates),")</span></div>\n        <ul>").concat(e.bullets.map(e=>"<li>".concat(p(e),"</li>")).join(""),"</ul>\n      </div>\n    ")).join(""),"\n  </div>\n  ").concat(s.includeSkills&&(null===(n=e.skills)||void 0===n?void 0:n.length)?'<div class="sec"><h2>Core Skills</h2><div>'.concat((e.skills||[]).join(" • "),"</div></div>"):"","\n  ").concat((null===(l=e.education)||void 0===l?void 0:l.length)?'<div class="sec"><h2>Education</h2><ul>'.concat((e.education||[]).map(e=>"<li>".concat(p(e),"</li>")).join(""),"</ul></div>"):"","\n  </div></body></html>")}function p(e){return(e||"").replace(/[&<>]/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;"})[e])}function h(e,s){var t,n,l;let i=e.contact||{};return'<!doctype html><html><head><meta charset="utf-8" /><style>'.concat('\n  body{font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, "Helvetica Neue", Helvetica, sans-serif; color:#111; font-size:11.5pt; line-height:1.4}\n  .wrap{max-width:820px; margin:0 auto}\n  h1{font-size:18pt; margin:0 0 6px; font-weight:700}\n  h2{font-size:12.5pt; margin:12px 0 6px}\n  .sec{margin: 6px 0 10px}\n  ul{margin:4px 0 0 16px; padding:0}\n  li{margin:2px 0}\n  .meta{color:#666}\n  ','</style></head><body><div class="wrap">\n    <h1>').concat(g(i.name||""),"</h1>\n    ").concat(s.includeSummary&&e.summary?'<div class="sec"><h2>Research Summary</h2><div>'.concat(g(e.summary),"</div></div>"):"","\n    ").concat(v("Projects",(null===(t=e.projects)||void 0===t?void 0:t.map(e=>"".concat(g(e.name)," — ").concat(e.bullets.map(e=>g(e)).join("; "))))||[]),"\n    ").concat(v("Publications",e.publications||[]),"\n    ").concat(v("Teaching",e.teaching||[]),"\n    ").concat(v("Experience",(e.experience||[]).map(e=>"".concat(g(e.role)," — ").concat(g(e.company)," <span class=meta>(").concat(g(e.dates),")</span>"))),"\n    ").concat(s.includeSkills&&(null===(n=e.skills)||void 0===n?void 0:n.length)?'<div class="sec"><h2>Skills</h2><div>'.concat((e.skills||[]).join(" • "),"</div></div>"):"","\n    ").concat((null===(l=e.education)||void 0===l?void 0:l.length)?'<div class="sec"><h2>Education</h2><ul>'.concat((e.education||[]).map(e=>"<li>".concat(g(e),"</li>")).join(""),"</ul></div>"):"","\n  </div></body></html>")}function v(e,s){return s&&s.length?'<div class="sec"><h2>'.concat(e,"</h2><ul>").concat(s.map(e=>"<li>".concat(e,"</li>")).join(""),"</ul></div>"):""}function g(e){return(e||"").replace(/[&<>]/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;"})[e])}function b(e){let{diffs:s}=e,[t,i]=(0,l.useState)("all"),a=(0,l.useMemo)(()=>["all",...new Set(s.map(e=>e.role))],[s]),c=(0,l.useMemo)(()=>s.filter(e=>"all"===t||e.role===t),[s,t]);return(0,n.jsxs)("div",{className:"border rounded-md p-3 bg-gray-50 text-xs max-h-96 overflow-auto",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)("span",{className:"label",children:"Section"}),(0,n.jsx)("select",{className:"input w-auto",value:t,onChange:e=>i(e.target.value),children:a.map(e=>(0,n.jsx)("option",{value:e,children:e},e))})]}),0===c.length&&(0,n.jsx)("div",{className:"text-gray-500",children:"No changes."}),c.map((e,s)=>(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("div",{className:"font-medium",children:e.role}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2 mt-1",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"label",children:"Original"}),(0,n.jsx)("ul",{className:"list-disc pl-4",children:e.original.map((e,s)=>(0,n.jsx)("li",{className:"line-through text-gray-500",children:e},s))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"label",children:"Tailored"}),(0,n.jsx)("ul",{className:"list-disc pl-4",children:e.tailored.map((s,t)=>(0,n.jsx)("li",{className:"text-green-700 underline decoration-green-400",title:(e.reasons||[]).join(" • "),children:s},t))})]})]})]},s))]})}function f(e){var s;let{stats:t}=e,l=Math.round(100*((null==t?void 0:t.coverage)||0)),i=Math.round(100*((null==t?void 0:t.mustCoverage)||0)),a=Math.round(100*((null==t?void 0:t.niceCoverage)||0)),c=Math.round(100*((null==t?void 0:t.semanticCoverage)||0));return(0,n.jsxs)("div",{className:"border rounded-md p-3 bg-white",children:[(0,n.jsx)("div",{className:"font-medium mb-1",children:"ATS Check"}),(0,n.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Keyword coverage and sanity checks."}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"w-full bg-gray-100 h-2 rounded",children:(0,n.jsx)("div",{className:"h-2 rounded",style:{width:l+"%",background:l>=80?"#10B981":l>=60?"#F59E0B":"#EF4444"}})}),(0,n.jsxs)("div",{className:"text-sm",children:[l,"% overall"]})]}),(0,n.jsx)("div",{className:"mt-2 text-xs text-gray-600",children:"Must-haves"}),(0,n.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,n.jsx)("div",{className:"w-full bg-gray-100 h-2 rounded",children:(0,n.jsx)("div",{className:"h-2 rounded",style:{width:i+"%",background:i>=80?"#10B981":i>=60?"#F59E0B":"#EF4444"}})}),(0,n.jsxs)("div",{className:"text-sm",children:[i,"%"]})]}),(0,n.jsx)("div",{className:"mt-2 text-xs text-gray-600",children:"Nice-to-haves"}),(0,n.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,n.jsx)("div",{className:"w-full bg-gray-100 h-2 rounded",children:(0,n.jsx)("div",{className:"h-2 rounded",style:{width:a+"%",background:a>=80?"#10B981":a>=60?"#F59E0B":"#EF4444"}})}),(0,n.jsxs)("div",{className:"text-sm",children:[a,"%"]})]}),(0,n.jsx)("div",{className:"mt-2 text-xs text-gray-600",children:"Semantic coverage"}),(0,n.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,n.jsx)("div",{className:"w-full bg-gray-100 h-2 rounded",children:(0,n.jsx)("div",{className:"h-2 rounded",style:{width:c+"%",background:c>=80?"#10B981":c>=60?"#F59E0B":"#EF4444"}})}),(0,n.jsxs)("div",{className:"text-sm",children:[c,"%"]})]}),(0,n.jsxs)("div",{className:"text-xs mb-2",children:[(0,n.jsx)("strong",{children:"Top missing:"})," ",((null==t?void 0:t.topMissing)||[]).slice(0,5).join(", ")||"—"]}),Array.isArray(null==t?void 0:t.gaps)&&t.gaps.length>0&&(0,n.jsxs)("div",{className:"text-xs mt-2",children:[(0,n.jsx)("div",{className:"label mb-1",children:"Gap map (nearest support)"}),(0,n.jsx)("ul",{className:"list-disc ml-4",children:t.gaps.slice(0,5).map((e,s)=>(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:e.requirement}),' → match "',e.nearestBullet,'" (score ',Math.round(100*(e.score||0))/100,")"]},s))})]}),(0,n.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-3 text-xs",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"label",children:"Matched"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-1",children:((null==t?void 0:t.matched)||[]).slice(0,20).map((e,s)=>(0,n.jsx)("span",{className:"badge border-green-300",children:e},s))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"label",children:"Missing (relevant)"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-1",children:((null==t?void 0:t.missing)||[]).slice(0,20).map((e,s)=>(0,n.jsx)("span",{className:"badge border-red-300",children:e},s))})]})]}),(null==t?void 0:null===(s=t.warnings)||void 0===s?void 0:s.length)>0&&(0,n.jsx)("div",{className:"mt-3 text-xs text-red-600",children:t.warnings.map((e,s)=>(0,n.jsxs)("div",{children:["⚠️ ",e]},s))})]})}function j(e){let{sessionId:s,onClose:t}=e,[i,a]=(0,l.useState)("minimal"),[c,o]=(0,l.useState)("pdf"),[r,d]=(0,l.useState)(!0),[u,m]=(0,l.useState)(!0),[x,p]=(0,l.useState)(!1),[h,v]=(0,l.useState)(null);async function g(){p(!0);try{var e,t;let n=window.__TAILOR_SESSION__||null,l=null===(e=document.cookie.split("; ").find(e=>e.startsWith("invite=")))||void 0===e?void 0:e.split("=")[1],a=l?decodeURIComponent(l):"",o=await fetch("/api/export",{method:"POST",headers:{"Content-Type":"application/json","x-invite-code":a},body:JSON.stringify({session_id:s,template:i,format:c,options:{includeSkills:r,includeSummary:u},session_snapshot:n})});if(!o.ok){let e=null;try{e=await o.json()}catch(e){}throw Error((null==e?void 0:e.message)||"Export HTTP ".concat(o.status))}let d=o.headers.get("content-type")||"",m=/^application\/pdf/i.test(d),x=/^application\/vnd\.openxmlformats/i.test(d);if(!m&&!x){let e=await o.text();throw Error("Malformed export response: ".concat(e.slice(0,300)))}t=await o.blob(),v(URL.createObjectURL(t))}catch(e){alert((null==e?void 0:e.message)||"Failed to export.")}finally{p(!1)}}return(0,n.jsx)("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"card p-6 w-[560px] max-w-full",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("div",{className:"font-semibold",children:"Export"}),(0,n.jsx)("button",{className:"button-outline",onClick:t,children:"Close"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"label mb-1",children:"Template"}),(0,n.jsxs)("select",{className:"input",value:i,onChange:e=>a(e.target.value),children:[(0,n.jsx)("option",{value:"classic",children:"Classic"}),(0,n.jsx)("option",{value:"modern",children:"Modern"}),(0,n.jsx)("option",{value:"minimal",children:"Minimal"}),(0,n.jsx)("option",{value:"executive",children:"Executive"}),(0,n.jsx)("option",{value:"academic",children:"Academic/Projects"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"label mb-1",children:"Format"}),(0,n.jsxs)("select",{className:"input",value:c,onChange:e=>o(e.target.value),children:[(0,n.jsx)("option",{value:"pdf",children:"PDF"}),(0,n.jsx)("option",{value:"docx",children:"DOCX"})]})]})]}),(0,n.jsxs)("div",{className:"mt-3 flex items-center gap-4",children:[(0,n.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,n.jsx)("input",{type:"checkbox",checked:u,onChange:e=>m(e.target.checked)}),"Include Summary"]}),(0,n.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,n.jsx)("input",{type:"checkbox",checked:r,onChange:e=>d(e.target.checked)}),"Include Skills"]})]}),(0,n.jsxs)("div",{className:"mt-4 flex items-center gap-3",children:[(0,n.jsx)("button",{className:"button",onClick:g,disabled:x,children:x?"Exporting…":"Export"}),h&&(0,n.jsx)("a",{className:"button-outline",href:h,target:"_blank",rel:"noreferrer",children:"Download"})]}),(0,n.jsx)("div",{className:"text-xs text-gray-500 mt-3",children:"DOCX exports instantly. PDF may take a few seconds. All exports are text-selectable and ATS-safe."})]})})}function y(e){var s;let{session:t}=e,[i,a]=(0,l.useState)(!1),[o,d]=(0,l.useState)("tailored"),[m,p]=(0,l.useState)("minimal"),[v,g]=(0,l.useState)(null),[y,N]=(0,l.useState)(!1),[w,k]=(0,l.useState)([]),S=(0,l.useMemo)(()=>t.preview_sections_json?_(t.preview_sections_json,m):"<p>No tailored content available</p>",[t,m]),C=(0,l.useMemo)(()=>t.original_sections_json?_(t.original_sections_json,m):"<p>No original content available</p>",[t,m]);function _(e,s){let t={includeSkills:!0,includeSummary:!0};return"classic"===s?u(e,t):"modern"===s?r(e,t):"executive"===s?x(e,t):"academic"===s?h(e,t):c(e,t)}async function E(){try{let e=await fetch("/api/diff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:t.session_id,session_version:t.version,original_payload:t.original_sections_json,tailored_payload:t.preview_sections_json})}),s=await e.json();e.ok?k(s.diffs||[]):"stale_session"===s.code&&(console.warn("Session is stale, refreshing..."),alert("Session data is outdated. Please refresh the page."))}catch(e){console.error("Failed to load diffs:",e)}}async function P(){N(!0);try{var e;let s=null===(e=document.cookie.split("; ").find(e=>e.startsWith("invite=")))||void 0===e?void 0:e.split("=")[1],n=s?decodeURIComponent(s):"",l=await fetch("/api/honesty",{method:"POST",headers:{"Content-Type":"application/json","x-invite-code":n},body:JSON.stringify({session_id:t.session_id,session_version:t.version,original_payload:t.original_sections_json,tailored_payload:t.preview_sections_json})}),i=await l.json();if(!l.ok){if("stale_session"===i.code){alert("Session data is outdated. Please refresh the page and try again.");return}throw Error((null==i?void 0:i.message)||"Honesty scan failed")}g(i)}catch(e){alert((null==e?void 0:e.message)||"Honesty scan failed")}finally{N(!1)}}return(0,l.useEffect)(()=>{try{window.__TAILOR_SESSION__=t}catch(e){}},[t]),(0,l.useEffect)(()=>{E()},[t]),(0,n.jsxs)("section",{className:"card p-6",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,n.jsx)("h2",{children:"Preview"}),(0,n.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,n.jsx)("button",{className:"button-outline ".concat("tailored"===o?"border-black":""),onClick:()=>d("tailored"),children:"Tailored"}),(0,n.jsx)("button",{className:"button-outline ".concat("original"===o?"border-black":""),onClick:()=>d("original"),children:"Original"}),(0,n.jsx)("button",{className:"button-outline",onClick:P,disabled:y,children:y?"Scanning...":"Honesty scan"}),(0,n.jsx)("button",{className:"button",onClick:()=>a(!0),children:"Export"})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,n.jsx)("div",{className:"label",children:"Template"}),(0,n.jsxs)("select",{className:"input w-auto",value:m,onChange:e=>p(e.target.value),children:[(0,n.jsx)("option",{value:"classic",children:"Classic"}),(0,n.jsx)("option",{value:"modern",children:"Modern"}),(0,n.jsx)("option",{value:"minimal",children:"Minimal"}),(0,n.jsx)("option",{value:"executive",children:"Executive"}),(0,n.jsx)("option",{value:"academic",children:"Academic/Projects"})]})]}),(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"label mb-2",children:["Resume Preview (",o,")"]}),(0,n.jsx)("div",{className:"bg-gray-50 p-3 rounded overflow-auto text-xs h-96 border",dangerouslySetInnerHTML:{__html:"tailored"===o?S:C}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"label mb-2",children:"Changes"}),(0,n.jsx)(b,{diffs:w}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(f,{stats:t.keyword_stats})}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("div",{className:"label mb-2",children:"Visual preview"}),(0,n.jsx)("iframe",{className:"w-full h-96 bg-white border rounded",srcDoc:function(){let e=t.preview_sections_json,s={includeSkills:!0,includeSummary:!0};return"classic"===m?u(e,s):"modern"===m?r(e,s):"executive"===m?x(e,s):"academic"===m?h(e,s):c(e,s)}()})]})]})]}),v&&(0,n.jsxs)("div",{className:"mt-4 border rounded-md p-3 bg-white",children:[(0,n.jsx)("div",{className:"font-medium mb-1",children:"Honesty scan"}),(null===(s=v.flags)||void 0===s?void 0:s.length)?v.flags.map((e,s)=>(0,n.jsxs)("div",{className:"mb-2 text-xs",children:[(0,n.jsxs)("div",{children:["⚠️ ",(0,n.jsx)("strong",{children:e.role}),": ",e.bullet]}),(0,n.jsxs)("div",{className:"text-gray-600",children:["Backed by: ",(e.backing||[]).join(" | ")||"No close match in original."]})]},s)):(0,n.jsx)("div",{className:"text-xs text-green-700",children:"All rewritten bullets appear supported by the original."})]}),i&&(0,n.jsx)(j,{sessionId:t.session_id,onClose:()=>a(!1)})]})}function N(e){let{validation:s,onAction:t,onDismiss:i,resumeText:a}=e,[c,o]=(0,l.useState)(!1),r=s.hasExperience?s.experienceCount>0&&s.experienceCount<2?{type:"warning",title:"Limited Experience Found",message:"Only ".concat(s.experienceCount," work experience found. More experience will improve tailoring results."),actions:[{label:"Add More Experience",action:"add_experience"},{label:"Continue Anyway",action:"continue"}]}:s.hasSkills?{type:"success",title:"Resume Parsed Successfully",message:"Your resume has been parsed and is ready for tailoring.",actions:[{label:"Continue to Tailoring",action:"continue"}]}:{type:"warning",title:"Skills Section Missing",message:"No skills section detected. Adding skills will improve ATS compatibility.",actions:[{label:"Add Skills",action:"add_skills"},{label:"Continue Without Skills",action:"continue"}]}:{type:"error",title:"Experience Not Found",message:"We couldn't find any work experience in your resume. This is required for tailoring.",actions:[{label:"Paste Work History",action:"paste_experience"},{label:"Mark Lines as Experience",action:"mark_experience"},{label:"Try Different Resume",action:"upload_new"}]};if("success"===r.type)return null;let d="error"===r.type;return(0,n.jsx)("div",{className:"fixed top-0 left-0 right-0 z-50 ".concat(d?"bg-red-50 border-b border-red-200":"bg-yellow-50 border-b border-yellow-200"),children:(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{className:"flex-shrink-0 ".concat(d?"text-red-400":"text-yellow-400"),children:d?(0,n.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}):(0,n.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-sm font-medium ".concat(d?"text-red-800":"text-yellow-800"),children:r.title}),(0,n.jsx)("p",{className:"text-sm ".concat(d?"text-red-700":"text-yellow-700"),children:r.message})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[s.suggestions.length>0&&(0,n.jsxs)("button",{onClick:()=>o(!c),className:"text-sm font-medium ".concat(d?"text-red-600 hover:text-red-500":"text-yellow-600 hover:text-yellow-500"),children:[c?"Hide":"Show"," Suggestions"]}),i&&!d&&(0,n.jsx)("button",{onClick:i,className:"text-yellow-600 hover:text-yellow-500",children:(0,n.jsx)("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}),c&&s.suggestions.length>0&&(0,n.jsx)("div",{className:"mt-3 pl-8",children:(0,n.jsx)("ul",{className:"list-disc list-inside space-y-1",children:s.suggestions.map((e,s)=>(0,n.jsx)("li",{className:"text-sm ".concat(d?"text-red-700":"text-yellow-700"),children:e},s))})}),(0,n.jsx)("div",{className:"mt-3 pl-8",children:(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:r.actions.map((e,s)=>(0,n.jsx)("button",{onClick:()=>t(e.action),className:"px-3 py-1 text-sm font-medium rounded-md ".concat(d?"bg-red-100 text-red-800 hover:bg-red-200":"bg-yellow-100 text-yellow-800 hover:bg-yellow-200"),children:e.label},s))})})]})})}function w(e){let{isOpen:s,onClose:t,onSubmit:i,originalText:a}=e,[c,o]=(0,l.useState)(a||""),[r,d]=(0,l.useState)(!1);if(!s)return null;let u=async()=>{if(c.trim()){d(!0);try{await i(c.trim()),t()}catch(e){console.error("Failed to submit experience:",e)}finally{d(!1)}}};return(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Add Work Experience"}),(0,n.jsx)("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Paste your work experience below. Include job titles, companies, dates, and bullet points describing your responsibilities and achievements."}),(0,n.jsx)("textarea",{value:c,onChange:e=>o(e.target.value),placeholder:"Example: Software Engineer at Google (2020-2023) • Developed scalable web applications using React and Node.js • Led a team of 5 engineers to deliver features on time • Improved application performance by 40%  Senior Developer at Microsoft (2018-2020) • Built microservices architecture for enterprise clients • Mentored junior developers and conducted code reviews • Reduced system downtime by 60%",className:"w-full h-64 p-3 border border-gray-300 rounded-md resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,n.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,n.jsx)("button",{onClick:t,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50",disabled:r,children:"Cancel"}),(0,n.jsx)("button",{onClick:u,disabled:!c.trim()||r,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Processing...":"Add Experience"})]})]})})}function k(e){let{lines:s,onSelectionChange:t,initialSelections:i=[]}=e,[a,c]=(0,l.useState)(i);(0,l.useEffect)(()=>{c(i)},[i]);let o=e=>{let s=e.trim();return/\b(19|20)\d{2}\b/.test(s)||/\b(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)\b/i.test(s)?"date":/^[A-Z][A-Z\s&.,-]+$/.test(s)&&(/\b(inc|llc|corp|ltd|company|co|group|technologies|systems)\b/i.test(s)||s.length>10)?"company":/^[A-Z][a-z\s&.,-]+$/.test(s)&&(/\b(engineer|developer|manager|director|analyst|specialist|coordinator|lead|senior|junior)\b/i.test(s)||s.length>5&&s.length<50)?"role":/^[•\-\*]\s+/.test(s)||/^(developed|implemented|created|designed|managed|led|built|improved|increased|reduced)/i.test(s)?"bullet":"other"},r=e=>{switch(e){case"company":return"bg-blue-50 border-blue-200 text-blue-800";case"role":return"bg-green-50 border-green-200 text-green-800";case"date":return"bg-purple-50 border-purple-200 text-purple-800";case"bullet":return"bg-yellow-50 border-yellow-200 text-yellow-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}},d=(e,s)=>{if(a.findIndex(s=>s.lineIndex===e)>=0){let s=a.filter(s=>s.lineIndex!==e);c(s),t(s)}else{let n=o(s),l=[...a,{lineIndex:e,lineText:s,type:n}].sort((e,s)=>e.lineIndex-s.lineIndex);c(l),t(l)}},u=e=>a.some(s=>s.lineIndex===e),m=e=>{var s;return null===(s=a.find(s=>s.lineIndex===e))||void 0===s?void 0:s.groupId};return(0,n.jsxs)("div",{className:"p-4 space-y-2",children:[s.map((e,s)=>{let t=u(s),l=o(e),i=m(s),a=r(l);return(0,n.jsxs)("div",{className:"\n              flex items-start gap-3 p-3 rounded-md border cursor-pointer transition-all\n              ".concat(t?"bg-blue-100 border-blue-300 shadow-sm":"hover:bg-gray-50 border-gray-200","\n            "),onClick:()=>d(s,e),children:[(0,n.jsx)("div",{className:"flex-shrink-0 mt-1",children:(0,n.jsx)("input",{type:"checkbox",checked:t,onChange:()=>d(s,e),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,n.jsx)("span",{className:"text-xs text-gray-500 font-mono",children:String(s+1).padStart(3,"0")}),(0,n.jsx)("span",{className:"px-2 py-1 text-xs rounded-full border ".concat(a),children:l}),i&&(0,n.jsxs)("span",{className:"px-2 py-1 text-xs bg-indigo-100 text-indigo-700 rounded-full",children:["Group ",i.split("_")[1]]})]}),(0,n.jsx)("div",{className:"text-sm text-gray-800 break-words",children:e||(0,n.jsx)("span",{className:"text-gray-400 italic",children:"(empty line)"})})]})]},s)}),0===s.length&&(0,n.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No lines found in resume text"})]})}function S(e){let{selections:s,lines:t}=e,i=(0,l.useMemo)(()=>{if(0===s.length)return[];let e={},t=[];s.forEach(s=>{s.groupId?(e[s.groupId]||(e[s.groupId]=[]),e[s.groupId].push(s)):t.push(s)});let n=[];if(Object.entries(e).forEach(e=>{let[s,t]=e,l=t.sort((e,s)=>e.lineIndex-s.lineIndex),i="",a="",c="",o=[];l.forEach(e=>{let s=e.lineText.trim();switch(e.type){case"company":i||(i=s);break;case"role":a||(a=s);break;case"date":c||(c=s);break;case"bullet":o.push(s);break;default:/^[A-Z][A-Z\s&.,-]+$/.test(s)&&s.length>5?i||(i=s):/^[A-Z][a-z\s&.,-]+$/.test(s)&&s.length>3&&s.length<50?a||(a=s):/\b(19|20)\d{2}\b/.test(s)?c||(c=s):o.push(s)}}),n.push({groupId:s,company:i||"Unknown Company",role:a||"Unknown Role",dates:c||"No dates specified",bullets:o,ungroupedLines:[]})}),t.length>0){let e=t.map(e=>e.lineText.trim());n.push({groupId:"ungrouped",company:"Ungrouped Experience",role:"Various Roles",dates:"Various Dates",bullets:[],ungroupedLines:e})}return n},[s]),a=(0,l.useMemo)(()=>i.reduce((e,s)=>e+s.bullets.length,0),[i]);return 0===s.length?(0,n.jsxs)("div",{className:"p-4 text-center text-gray-500",children:[(0,n.jsx)("div",{className:"mb-2",children:"\uD83D\uDCDD"}),(0,n.jsx)("p",{children:"No lines selected"}),(0,n.jsx)("p",{className:"text-sm",children:"Click on lines in the left panel to mark them as experience"})]}):(0,n.jsxs)("div",{className:"p-4 space-y-4",children:[(0,n.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:[(0,n.jsx)("h4",{className:"font-medium text-blue-800 mb-1",children:"Selection Summary"}),(0,n.jsxs)("div",{className:"text-sm text-blue-700",children:[(0,n.jsxs)("div",{children:["• ",s.length," lines selected"]}),(0,n.jsxs)("div",{children:["• ",i.length," experience entries"]}),(0,n.jsxs)("div",{children:["• ",a," bullet points"]})]})]}),i.map((e,s)=>(0,n.jsxs)("div",{className:"border border-gray-200 rounded-md p-4",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium text-gray-800",children:e.company}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:e.role}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:e.dates})]}),(0,n.jsxs)("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full",children:["Entry ",s+1]})]}),e.bullets.length>0&&(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Bullet Points:"}),(0,n.jsx)("ul",{className:"space-y-1",children:e.bullets.map((e,s)=>(0,n.jsxs)("li",{className:"text-sm text-gray-600 flex items-start",children:[(0,n.jsx)("span",{className:"text-gray-400 mr-2",children:"•"}),(0,n.jsx)("span",{children:e})]},s))})]}),e.ungroupedLines.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Additional Lines:"}),(0,n.jsx)("div",{className:"space-y-1",children:e.ungroupedLines.map((e,s)=>(0,n.jsx)("div",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:e},s))})]}),0===e.bullets.length&&0===e.ungroupedLines.length&&(0,n.jsx)("div",{className:"text-sm text-gray-500 italic",children:"No detailed content selected for this entry"})]},e.groupId)),(0,n.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3",children:[(0,n.jsx)("h4",{className:"font-medium text-yellow-800 mb-1",children:"Next Steps"}),(0,n.jsxs)("div",{className:"text-sm text-yellow-700",children:[(0,n.jsx)("div",{children:"• Selected lines will be processed into structured experience data"}),(0,n.jsx)("div",{children:"• AI will tailor this experience to match the job description"}),(0,n.jsx)("div",{children:"• You can edit the results in the preview after processing"})]})]})]})}function C(e){let{isOpen:s,onClose:t,onSubmit:i,resumeText:a,originalResume:c}=e,[o,r]=(0,l.useState)([]),[d,u]=(0,l.useState)(!1),[m,x]=(0,l.useState)(""),p=a.split("\n").map((e,s)=>({index:s,text:e.trim(),isEmpty:!e.trim()})).filter(e=>!e.isEmpty);(0,l.useEffect)(()=>{s&&(r([]),x(""))},[s]);let h=async()=>{if(0!==o.length){u(!0);try{await i(o),t()}catch(e){console.error("Failed to submit line selections:",e)}finally{u(!1)}}};return s?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-6xl w-full mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Mark Lines as Experience"}),(0,n.jsx)("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Click on lines to mark them as experience. Group related lines together to form complete experience entries. Selected lines will be processed into structured experience data."})}),(0,n.jsxs)("div",{className:"flex-1 grid grid-cols-2 gap-6 overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,n.jsxs)("h3",{className:"font-medium",children:["Resume Lines (",p.length," lines)"]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>{if(0===o.length)return;o.map(e=>e.lineIndex);let e="group_".concat(Date.now());r(o.map(s=>({...s,groupId:e}))),x(e)},disabled:0===o.length,className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Group Selected"}),(0,n.jsx)("button",{onClick:()=>{r([]),x("")},disabled:0===o.length,className:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Clear All"})]})]}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto border rounded-md",children:(0,n.jsx)(k,{lines:p.map(e=>e.text),onSelectionChange:e=>{r(e)},initialSelections:o})})]}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("h3",{className:"font-medium mb-3",children:["Experience Preview (",o.length," lines selected)"]}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto border rounded-md",children:(0,n.jsx)(S,{selections:o,lines:p.map(e=>e.text)})})]})]}),(0,n.jsxs)("div",{className:"flex justify-end gap-3 mt-4 pt-4 border-t",children:[(0,n.jsx)("button",{onClick:t,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50",disabled:d,children:"Cancel"}),(0,n.jsx)("button",{onClick:h,disabled:0===o.length||d,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Processing...":"Process ".concat(o.length," Lines")})]})]})}):null}let _=t.n(i)()(()=>Promise.all([t.e(486),t.e(971),t.e(328)]).then(t.bind(t,5328)),{loadableGenerated:{webpack:()=>[5328]},ssr:!1});function E(){let[e,s]=(0,l.useState)(null),[t,i]=(0,l.useState)(""),[c,o]=(0,l.useState)("professional"),[r,d]=(0,l.useState)(null),[u,m]=(0,l.useState)(!1),[x,p]=(0,l.useState)(null),[h,v]=(0,l.useState)(!1),[g,b]=(0,l.useState)(!1),[f,j]=(0,l.useState)(!0),[k,S]=(0,l.useState)(""),E=function(){let[e,s]=(0,l.useState)(!1),[t,n]=(0,l.useState)("");return(0,l.useEffect)(()=>{s(document.cookie.includes("invite="))},[]),{ok:e,code:t,setCode:n,submit:function(){t&&(document.cookie="invite=".concat(encodeURIComponent(t),"; path=/; max-age=2592000"),s(!0))}}}();function P(){var e;let s=null===(e=document.cookie.split("; ").find(e=>e.startsWith("invite=")))||void 0===e?void 0:e.split("=")[1],t=s?decodeURIComponent(s):"";return console.log("Cookie debug:",{allCookies:document.cookie,inviteCode:s,decoded:t}),t}async function I(e){try{let s=new FormData;s.append("file",e);let t=await fetch("/api/parse-resume",{method:"POST",body:s});if(t.ok)return(await t.json()).resumeText||""}catch(e){console.error("Failed to extract resume text:",e)}try{return await e.text()}catch(e){return console.error("Failed to read file as text:",e),""}}async function M(){if(!e)return alert("Upload a resume and paste a job description.");if(!t)return alert("Paste a job description.");m(!0);try{let s=await I(e);S(s);let n=new FormData;n.append("resume_file",e),n.append("jd_text",t),n.append("tone",c);let l=P();console.log("API call debug:",{inviteCode:l,formDataEntries:[...n.entries()],headers:{"x-invite-code":l}});let i=await fetch("/api/tailor",{method:"POST",body:n,headers:{"x-invite-code":l}}),a=await i.json();if(!i.ok){if("missing_experience"===a.code){p(a.validation),j(!0),m(!1);return}throw Error((null==a?void 0:a.message)||"Tailoring failed.")}d(a),p(a.validation),j(!1)}catch(e){alert((null==e?void 0:e.message)||"Failed to tailor.")}finally{m(!1)}}async function T(e){if(!t){alert("Job description is required. Please paste a job description first.");return}m(!0);try{let s=await fetch("/api/process-experience",{method:"POST",headers:{"Content-Type":"application/json","x-invite-code":P()},body:JSON.stringify({experienceText:e,jdText:t,tone:c,sessionId:null==r?void 0:r.session_id})}),n=await s.json();if(!s.ok)throw Error((null==n?void 0:n.message)||"Failed to process experience");d(n),p(null),j(!1),v(!1),console.log("Experience processed successfully:",{extractedExperienceCount:n.extracted_experience_count})}catch(e){console.error("Failed to process experience:",e),alert((null==e?void 0:e.message)||"Failed to process experience")}finally{m(!1)}}async function R(e){if(!k||!t){alert("Missing resume text or job description. Please try again.");return}m(!0);try{let s=await fetch("/api/process-line-selections",{method:"POST",headers:{"Content-Type":"application/json","x-invite-code":P()},body:JSON.stringify({resumeText:k,selectedLines:e,jdText:t,tone:c,sessionId:null==r?void 0:r.session_id})}),n=await s.json();if(!s.ok)throw Error((null==n?void 0:n.message)||"Failed to process line selections");d(n),p(null),j(!1),b(!1),console.log("Line selections processed successfully:",n.processing_summary)}catch(e){console.error("Failed to process line selections:",e),alert((null==e?void 0:e.message)||"Failed to process line selections")}finally{m(!1)}}return E.ok?(0,n.jsxs)("main",{className:"grid gap-6",children:[x&&f&&(0,n.jsx)(N,{validation:x,onAction:function(e){switch(e){case"paste_experience":v(!0);break;case"mark_experience":if(!k){alert("Resume text not available. Please try uploading the resume again.");return}b(!0);break;case"upload_new":s(null),d(null),p(null),j(!1);break;case"continue":j(!1);break;default:console.log("Unknown action:",e)}},onDismiss:()=>j(!1),resumeText:k}),(0,n.jsxs)("section",{className:"card p-6",children:[(0,n.jsx)("h1",{className:"mb-1",children:"AI Resume Tailor"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:"Upload your resume and paste a job description to get a tailored version."}),(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"label mb-2",children:"Resume"}),(0,n.jsx)(_,{onFile:s}),e&&(0,n.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",e.name]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"label mb-2",children:"Job Description"}),(0,n.jsx)(a,{value:t,onChange:i})]})]}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("div",{className:"label mb-2",children:"Tone"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{className:"button-outline ".concat("professional"===c?"border-black":""),onClick:()=>o("professional"),children:"Professional"}),(0,n.jsx)("button",{className:"button-outline ".concat("concise"===c?"border-black":""),onClick:()=>o("concise"),children:"Concise"}),(0,n.jsx)("button",{className:"button-outline ".concat("impact-heavy"===c?"border-black":""),onClick:()=>o("impact-heavy"),children:"Impact Heavy"})]})]}),(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsx)("button",{className:"button",onClick:M,disabled:u||!e||!t,children:u?"Tailoring...":"Tailor Resume"})})]}),r&&(0,n.jsx)(y,{session:r}),h&&(0,n.jsx)(w,{isOpen:h,onClose:()=>v(!1),onSubmit:T}),g&&(0,n.jsx)(C,{isOpen:g,onClose:()=>b(!1),onSubmit:R,resumeText:k,originalResume:null==r?void 0:r.original_sections_json})]}):(0,n.jsx)("main",{className:"grid gap-6",children:(0,n.jsxs)("section",{className:"card p-6",children:[(0,n.jsx)("h1",{className:"mb-1",children:"Enter Invite Code"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:"Access is limited during beta. Enter your invite code to continue."}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("input",{className:"input",placeholder:"Invite code",value:E.code,onChange:e=>E.setCode(e.target.value)}),(0,n.jsx)("button",{className:"button",onClick:E.submit,children:"Continue"})]})]})})}},551:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return i}});let n=t(9920);t(7437),t(2265);let l=n._(t(148));function i(e,s){var t;let n={loading:e=>{let{error:s,isLoading:t,pastDelay:n}=e;return null}};"function"==typeof e&&(n.loader=e);let i={...n,...s};return(0,l.default)({...i,modules:null==(t=i.loadableGenerated)?void 0:t.modules})}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),e.exports=s.default)},912:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let n=t(5592);function l(e){let{reason:s,children:t}=e;if("undefined"==typeof window)throw new n.BailoutToCSRError(s);return t}},148:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return r}});let n=t(7437),l=t(2265),i=t(912),a=t(1481);function c(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(c(()=>null)),loading:null,ssr:!0},r=function(e){let s={...o,...e},t=(0,l.lazy)(()=>s.loader().then(c)),r=s.loading;function d(e){let c=r?(0,n.jsx)(r,{isLoading:!0,pastDelay:!0,error:null}):null,o=s.ssr?(0,n.jsxs)(n.Fragment,{children:["undefined"==typeof window?(0,n.jsx)(a.PreloadCss,{moduleIds:s.modules}):null,(0,n.jsx)(t,{...e})]}):(0,n.jsx)(i.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(t,{...e})});return(0,n.jsx)(l.Suspense,{fallback:c,children:o})}return d.displayName="LoadableComponent",d}},1481:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"PreloadCss",{enumerable:!0,get:function(){return i}});let n=t(7437),l=t(8512);function i(e){let{moduleIds:s}=e;if("undefined"!=typeof window)return null;let t=(0,l.getExpectedRequestStore)("next/dynamic css"),i=[];if(t.reactLoadableManifest&&s){let e=t.reactLoadableManifest;for(let t of s){if(!e[t])continue;let s=e[t].files.filter(e=>e.endsWith(".css"));i.push(...s)}}return 0===i.length?null:(0,n.jsx)(n.Fragment,{children:i.map(e=>(0,n.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:t.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}},function(e){e.O(0,[478,23,744],function(){return e(e.s=4033)}),_N_E=e.O()}]);