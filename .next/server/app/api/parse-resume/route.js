"use strict";(()=>{var e={};e.id=310,e.ids=[310],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},97549:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>k,requestAsyncStorage:()=>d,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var i={};r.r(i),r.d(i,{POST:()=>f,dynamic:()=>u,runtime:()=>p});var n=r(49303),s=r(88716),o=r(60670),a=r(87070),l=r(48179),c=r(32064);let u="force-dynamic",p="nodejs";async function f(e){try{let t;let r=(0,c.d7)(e);if(!r.ok)return r.res;let i=(await e.formData()).get("file");if(!i)return a.NextResponse.json({code:"no_file",message:"No file provided"},{status:400});let{text:n}=await (0,l.H)(i),s=(0,l.r)(n),o=function(e){let t=0,r=0;for(let i of["summary","skills","experience","education","certifications"])r+=1,e[i]&&e[i].length>0&&(t+=1);return e.experience&&e.experience.length>0&&(e.experience.some(e=>e.bullets&&e.bullets.length>0)&&(t+=.5),r+=.5),e.skills&&e.skills.length>3&&(t+=.5,r+=.5),r>0?t/r:0}(s),u=o<.8;if(u){let e=function(e){let t=["summary","skills","experience","education","certifications"],r=[];for(let[i,n]of Object.entries(e))!t.includes(i)&&n&&Array.isArray(n)&&n.length>0?r.push(i):!t.includes(i)&&n&&"string"==typeof n&&n.length>0&&r.push(i);return r}(s);t=({standardSections:["summary","experience","skills","education","certifications"],sectionSynonyms:{summary:["profile","objective","about","overview","introduction","bio","biography","personal statement","professional summary"],experience:["work experience","professional experience","employment","work history","career history","professional background","work","career","professional"],skills:["technical skills","core competencies","key skills","competencies","tech stack","technologies","technical expertise","core skills","key competencies","technical competencies","professional skills","programming languages","software skills","tools","software"],education:["academic background","academic qualifications","academic credentials","academic","qualifications","credentials","degrees"],certifications:["certificates","certs","professional certifications","licenses","licences","credentials","professional credentials"]},suggestMapping(e){let t={};for(let r of e){let e=this.normalizeSectionName(r),i=this.findBestMatch(e);i&&(t[r]=i)}return t},normalizeSectionName:e=>e.toLowerCase().replace(/[:\-\*\.\s]+$/,"").replace(/^[:\-\*\.\s]+/,"").replace(/\s+/g," ").trim(),findBestMatch(e){let t="",r=0;for(let[i,n]of Object.entries(this.sectionSynonyms)){if(e===i)return i;for(let s of n){let n=this.calculateSimilarity(e,s);n>r&&n>.6&&(r=n,t=i)}}return t||null},calculateSimilarity(e,t){let r=e.split(/\s+/),i=t.split(/\s+/),n=new Set(r),s=new Set(i),o=new Set([...n].filter(e=>s.has(e))),a=new Set([...n,...s]);return a.size>0?o.size/a.size:0},applyMapping(e,t){let r={...e};for(let[e,i]of Object.entries(t))r[e]&&(r[i]=r[e],delete r[e]);return r},validateMapping(e){let t=[];for(let[r,i]of Object.entries(e))this.standardSections.includes(i)||t.push(`Invalid standard section: ${i}`);return{valid:0===t.length,errors:t}}}).suggestMapping(e)}return a.NextResponse.json({success:!0,resume:s,confidence:o,needsConfirmation:u,suggestedMapping:t,message:u?"Resume parsed with low confidence. Please confirm section mappings.":"Resume parsed successfully."})}catch(e){return console.error("Resume parsing error:",e),a.NextResponse.json({code:"parsing_failed",message:"Failed to parse resume",details:void 0},{status:500})}}let m=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/parse-resume/route",pathname:"/api/parse-resume",filename:"route",bundlePath:"app/api/parse-resume/route"},resolvedPagePath:"/Users/yassinkhalil/Downloads/ai-resume-tailor_v2_full/app/api/parse-resume/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:d,staticGenerationAsyncStorage:g,serverHooks:h}=m,y="/api/parse-resume/route";function k(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},74068:(e,t,r)=>{r.d(t,{iE:()=>a,rF:()=>l});var i=r(57147),n=r.n(i);let s="/tmp/ai-resume-tailor-config.json",o={rate:{ipPerMin:Number(process.env.RATE_IP_PER_MIN||30),sessionPerMin:Number(process.env.RATE_SESSION_PER_MIN||5)},invites:(process.env.INVITE_CODES||"").split(",").map(e=>e.trim()).filter(Boolean),openaiKey:void 0,pauseTailor:!1,pauseExport:!1};function a(){return o}function l(e){o={...o,...e,rate:{...o.rate,...e.rate||{}}},function(){try{n().writeFileSync(s,JSON.stringify(o,null,2))}catch{}}()}!function(){try{if(n().existsSync(s)){let e=n().readFileSync(s,"utf8"),t=JSON.parse(e);o={...o,...t}}}catch{}}()},32064:(e,t,r)=>{r.d(t,{d7:()=>p});var i=r(87070),n=r(74068);let s=new Map,o=new Map;function a(){return Date.now()}function l(e,t){let r=a();for(;e.length&&r-e[0]>t;)e.shift()}function c(e,t){let r=e.get(t)||[];return r.push(a()),e.set(t,r),r}function u(e,t){let r=(e.headers.get("cookie")||"").match(RegExp("(?:^|; )"+t+"=([^;]+)"));return r?decodeURIComponent(r[1]):null}function p(e){let t=(0,n.iE)();if(!function(e){let t=(0,n.iE)();if(!t.invites.length)return!0;let r=e.headers.get("x-invite-code")||"",i=u(e,"invite")||"",s=r||i;return!!s&&t.invites.includes(s)}(e))return{ok:!1,res:i.NextResponse.json({code:"invite_required",message:"Invite code required"},{status:403})};let r=(e.headers.get("x-forwarded-for")||"").split(",")[0].trim()||"0.0.0.0",p=u(e,"sid")||"anon",f=c(s,r),m=c(o,p);return(l(f,6e4),l(m,6e4),function(e=6e4,t=5e3){let r=a();for(let[t,i]of s){for(;i.length&&r-i[0]>e;)i.shift();0===i.length&&s.delete(t)}for(let[t,i]of o){for(;i.length&&r-i[0]>e;)i.shift();0===i.length&&o.delete(t)}if(s.size>t){for(let e of s.keys())if(s.delete(e),s.size<=t)break}if(o.size>t){for(let e of o.keys())if(o.delete(e),o.size<=t)break}}(),f.length>t.rate.ipPerMin||m.length>t.rate.sessionPerMin)?{ok:!1,res:i.NextResponse.json({code:"rate_limited",message:"Too many requests"},{status:429})}:{ok:!0}}},48179:(e,t,r)=>{r.d(t,{H:()=>n,r:()=>s});var i=r(47699);async function n(e){let t=Buffer.from(await e.arrayBuffer()),n=(e instanceof File?e.name.split(".").pop()?.toLowerCase():"txt")||"txt";if("pdf"===n)try{let e=await r.e(585).then(r.bind(r,17585)),i=await e.getDocument({data:t}).promise,s="";for(let e=1;e<=i.numPages;e++){let t=await i.getPage(e),r=await t.getTextContent();s+=r.items.map(e=>e.str).join(" ")+"\n"}return{text:s,ext:n}}catch(e){return console.error("PDF parsing failed:",e),{text:t.toString("utf8"),ext:"txt"}}else if("docx"===n)return{text:(await i.extractRawText({buffer:t})).value,ext:n};else return{text:t.toString("utf8"),ext:"txt"}}function s(e){var t,r;let i=(e||"").replace("\r","").split("\n").map(e=>e.trim()).filter(Boolean).join("\n"),n=function(e){let t={},r=e.split("\n"),i="",n=[];for(let e of r){let r=e.trim();(function(e){let t=o(e);return[/^(experience|work experience|professional experience|employment|work history|career history|professional background)$/,/^(work|employment|career|professional)$/,/^(skills|technical skills|core competencies|key skills|competencies|tech stack|technologies|technical expertise)$/,/^(core skills|key competencies|technical competencies|professional skills)$/,/^(programming languages|software skills|tools|software)$/,/^(summary|profile|objective|about|personal statement|professional summary)$/,/^(overview|introduction|bio|biography)$/,/^(education|academic background|academic qualifications|academic credentials)$/,/^(academic|qualifications|credentials|degrees)$/,/^(certifications|certificates|certs|professional certifications)$/,/^(licenses|licences|credentials|professional credentials)$/,/^(projects|project experience|project portfolio|key projects)$/,/^(portfolio|project work|project history)$/,/^(achievements|accomplishments|awards|honors|honours)$/,/^(recognition|awards and recognition|professional achievements)$/,/^(publications|research|volunteer|volunteer work|community service)$/,/^(languages|language skills|interests|hobbies|additional information)$/].some(e=>e.test(t))})(r)?(i&&(t[i.toLowerCase()]=n.join("\n")),i=r,n=[]):n.push(e)}return i&&(t[i.toLowerCase()]=n.join("\n")),t}(i);0!==Object.keys(n).length&&(t=n,["experience","skills","summary","education"].some(e=>t[e]&&t[e].trim().length>20))||(console.log("Primary parsing failed, attempting fallback segmentation"),n=function(e){console.log("Attempting fallback segmentation");let t=e.split("\n").map(e=>e.trim()).filter(Boolean),r={},i={experience:{indicators:["experience","work","employment","career","professional"],datePattern:/\b(19|20)\d{2}\b/,bulletPattern:/^[•\-\*]\s+/,companyPattern:/^[A-Z][^•\-\*]*[A-Z]/},skills:{indicators:["skills","competencies","technologies","tools","software"],listPattern:/^[A-Za-z][^•\-\*]*[,;]/,shortLinePattern:/^[A-Za-z\s]{2,30}$/},summary:{indicators:["summary","profile","objective","about"],longTextPattern:/^[A-Za-z][^•\-\*]{50,}/,firstSection:!0}},n="",s=[],a={};for(let e=0;e<t.length;e++){let l=t[e],c=o(l);for(let[t,r]of Object.entries(i)){let i=0;r.indicators.some(e=>c.includes(e))&&(i+=3),"experience"===t?(r.datePattern.test(l)&&(i+=2),r.bulletPattern.test(l)&&(i+=1),r.companyPattern.test(l)&&(i+=2)):"skills"===t?(r.listPattern.test(l)&&(i+=2),r.shortLinePattern.test(l)&&(i+=1)):"summary"===t&&(r.longTextPattern.test(l)&&(i+=2),r.firstSection&&e<5&&(i+=1)),a[t]=(a[t]||0)+i}let u=Object.entries(a).reduce((e,t)=>a[e[0]]>a[t[0]]?e:t);u[1]>2&&u[0]!==n?(n&&(r[n]=s.join("\n")),n=u[0],s=[l],a={}):s.push(l)}return(n&&(r[n]=s.join("\n")),0===Object.keys(r).length)?function(e){console.log("Attempting content-based segmentation");let t=e.split("\n").map(e=>e.trim()).filter(Boolean),r={},i="summary",n=[];for(let e of t)(function(e){return[/\b(19|20)\d{2}\b/,/\b(at|@|\-|\|)\b/,/\b(engineer|manager|developer|analyst|consultant|director|lead|senior|junior)\b/i,/\b(company|corp|inc|llc|ltd)\b/i].some(t=>t.test(e))})(e)?(n.length>0&&(r[i]=n.join("\n")),i="experience",n=[e]):function(e){return[/^[A-Za-z][^•\-\*]*[,;]/,/^[A-Za-z\s]{2,30}$/,/\b(java|python|javascript|react|angular|vue|node|sql|aws|azure|docker|kubernetes)\b/i].some(t=>t.test(e))}(e)?(n.length>0&&(r[i]=n.join("\n")),i="skills",n=[e]):n.push(e);return n.length>0&&(r[i]=n.join("\n")),r}(e):r}(i));let s=function(e){let t=[],r=e.split("\n").filter(Boolean),i=null;for(let e of r){let r=e.trim();(function(e){return[/^[^•\-\*].*(at|@|\-|\|).*[0-9]{4}/i,/^[A-Z][^•\-\*]*[A-Z].*[0-9]{4}/,/^[^•\-\*].*\b(19|20)\d{2}\b/,/^[A-Z][^•\-\*]*\b(engineer|manager|developer|analyst|consultant|director|lead|senior|junior)\b/i].some(t=>t.test(e))})(r)?(i&&t.push(i),i=function(e){let t=e.split(/at|@|\-|\||\b(19|20)\d{2}\b/).map(e=>(e||"").trim()).filter(Boolean);if(t.length>=2)return{role:t[0],company:t[1]||"Unknown",bullets:[]};let r=e.match(/\b(engineer|manager|developer|analyst|consultant|director|lead|senior|junior)\b/i),i=e.match(/\b[A-Z][^•\-\*]*[A-Z]\b/);return{role:r?r[0]:e,company:i?i[0]:"Unknown",bullets:[]}}(r)):i&&(/^[•\-\*]/.test(r)||/^[0-9]+\./.test(r))&&i.bullets.push(r)}return i&&t.push(i),t}(n.experience||n.work||n["work experience"]||n["professional experience"]||""),a=(r=n.skills||n["core competencies"]||n["technical skills"]||n["key skills"]||n["tech stack"]||n.competencies||"").trim()?r.split(/[•,;\n|]/).map(e=>e.trim()).filter(Boolean).filter(e=>e.length>2&&e.length<50).slice(0,60):[];return{summary:(n.summary||n.profile||n.objective||n.about||"").split("\n").slice(0,3).join(" "),skills:a,experience:s,education:(n.education||n["academic background"]||"").split("\n").filter(Boolean),certifications:(n.certifications||n.certificates||n.certs||"").split("\n").filter(Boolean)}}function o(e){return e.replace(/[:\-\*\.\s]+$/,"").replace(/^[:\-\*\.\s]+/,"").toLowerCase().replace(/\s+/g," ").trim()}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[948,972,969,699],()=>r(97549));module.exports=i})();