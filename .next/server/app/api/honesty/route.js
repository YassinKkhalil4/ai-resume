"use strict";(()=>{var e={};e.id=306,e.ids=[306],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},57147:e=>{e.exports=require("fs")},78160:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>y,requestAsyncStorage:()=>h,routeModule:()=>m,serverHooks:()=>v,staticGenerationAsyncStorage:()=>g});var n={};r.r(n),r.d(n,{POST:()=>f,dynamic:()=>d,runtime:()=>p});var o=r(49303),i=r(88716),s=r(60670),a=r(87070),u=r(45647);function l(e){return new Set((e.toLowerCase().match(/[a-z0-9\-\+\.]{3,}/g)||[]).filter(e=>!["and","the","for","with","from","this","that"].includes(e)))}var c=r(32064);let d="force-dynamic",p="nodejs";async function f(e){let t=(0,c.d7)(e);if(!t.ok)return t.res;let{session_id:r}=await e.json()||{},n=(0,u.G)(r||"");if(!n)return a.NextResponse.json({error:"Session not found"},{status:404});let o=function(e,t){let r=[],n=new Map;for(let t of e)n.set(t.company+"|"+t.role,t);for(let e of t){let t=e.company+"|"+e.role,o=n.get(t);if(o)for(let t of e.bullets){let n=l(t),i=0,s=[];for(let e of o.bullets){let t=function(e,t){let r=new Set([...e].filter(e=>t.has(e))),n=new Set([...e,...t]);return n.size?r.size/n.size:0}(n,l(e));t>i&&(i=t,s=[e])}i<.28&&r.push({role:`${e.role} @ ${e.company}`,bullet:t,score:Number(i.toFixed(2)),backing:s})}}return{flags:r}}(n.original.experience||[],n.tailored.experience||[]);return a.NextResponse.json(o)}let m=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/honesty/route",pathname:"/api/honesty",filename:"route",bundlePath:"app/api/honesty/route"},resolvedPagePath:"/Users/yassinkhalil/Downloads/ai-resume-tailor_v2_full/app/api/honesty/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:h,staticGenerationAsyncStorage:g,serverHooks:v}=m,x="/api/honesty/route";function y(){return(0,s.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:g})}},74068:(e,t,r)=>{r.d(t,{iE:()=>a,rF:()=>u});var n=r(57147),o=r.n(n);let i="/tmp/ai-resume-tailor-config.json",s={rate:{ipPerMin:Number(process.env.RATE_IP_PER_MIN||30),sessionPerMin:Number(process.env.RATE_SESSION_PER_MIN||5)},invites:(process.env.INVITE_CODES||"").split(",").map(e=>e.trim()).filter(Boolean),openaiKey:void 0};function a(){return s}function u(e){s={...s,...e,rate:{...s.rate,...e.rate||{}}},function(){try{o().writeFileSync(i,JSON.stringify(s,null,2))}catch{}}()}!function(){try{if(o().existsSync(i)){let e=o().readFileSync(i,"utf8"),t=JSON.parse(e);s={...s,...t}}}catch{}}()},32064:(e,t,r)=>{r.d(t,{d7:()=>d});var n=r(87070),o=r(74068);let i=new Map,s=new Map;function a(){return Date.now()}function u(e,t){let r=a();for(;e.length&&r-e[0]>t;)e.shift()}function l(e,t){let r=e.get(t)||[];return r.push(a()),e.set(t,r),r}function c(e,t){let r=(e.headers.get("cookie")||"").match(RegExp("(?:^|; )"+t+"=([^;]+)"));return r?decodeURIComponent(r[1]):null}function d(e){let t=(0,o.iE)();if(!function(e){let t=(0,o.iE)();if(!t.invites.length)return!0;let r=e.headers.get("x-invite-code")||"",n=c(e,"invite")||"",i=r||n;return!!i&&t.invites.includes(i)}(e))return{ok:!1,res:n.NextResponse.json({error:"Invite code required",code:"invite_required"},{status:403})};let r=(e.headers.get("x-forwarded-for")||"").split(",")[0].trim()||"0.0.0.0",a=c(e,"sid")||"anon",d=l(i,r),p=l(s,a);return(u(d,6e4),u(p,6e4),d.length>t.rate.ipPerMin)?{ok:!1,res:n.NextResponse.json({error:"Rate limit exceeded (ip)",code:"rate_ip"},{status:429})}:p.length>t.rate.sessionPerMin?{ok:!1,res:n.NextResponse.json({error:"Rate limit exceeded (session)",code:"rate_session"},{status:429})}:{ok:!0}}},45647:(e,t,r)=>{r.d(t,{G:()=>s,e:()=>i});var n=r(9576);let o=new Map;function i(e,t,r,i){let s=(0,n.Z)(),a={id:s,createdAt:Date.now(),original:e,tailored:t,jdText:r,keywordStats:i};return o.set(s,a),a}function s(e){let t=o.get(e);return t?Date.now()-t.createdAt>36e5?(o.delete(e),null):t:null}},9576:(e,t,r)=>{r.d(t,{Z:()=>l});var n=r(6113),o=r.n(n);let i={randomUUID:o().randomUUID},s=new Uint8Array(256),a=s.length,u=[];for(let e=0;e<256;++e)u.push((e+256).toString(16).slice(1));let l=function(e,t,r){if(i.randomUUID&&!t&&!e)return i.randomUUID();let n=(e=e||{}).random||(e.rng||function(){return a>s.length-16&&(o().randomFillSync(s),a=0),s.slice(a,a+=16)})();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return function(e,t=0){return u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]}(n)}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,972],()=>r(78160));module.exports=n})();