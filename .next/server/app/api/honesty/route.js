"use strict";(()=>{var e={};e.id=306,e.ids=[306],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},57147:e=>{e.exports=require("fs")},78160:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>y,requestAsyncStorage:()=>m,routeModule:()=>h,serverHooks:()=>v,staticGenerationAsyncStorage:()=>g});var n={};r.r(n),r.d(n,{POST:()=>p,dynamic:()=>c,runtime:()=>d});var o=r(49303),i=r(88716),s=r(60670),a=r(87070),l=r(45647);function u(e){return new Set((e.toLowerCase().match(/[a-z0-9\-\+\.]{3,}/g)||[]).filter(e=>!["and","the","for","with","from","this","that"].includes(e)))}var f=r(32064);let c="force-dynamic",d="nodejs";async function p(e){if(!process.env.OPENAI_API_KEY)return a.NextResponse.json({error:"Server not configured",code:"no_openai_key"},{status:503});let t=(0,f.d7)(e);if(!t.ok)return t.res;let{session_id:r}=await e.json()||{},n=(0,l.G)(r||"");if(!n)return a.NextResponse.json({error:"Session not found"},{status:404});let o=function(e,t){let r=[],n=new Map;for(let t of e)n.set(t.company+"|"+t.role,t);for(let e of t){let t=e.company+"|"+e.role,o=n.get(t);if(o)for(let t of e.bullets){let n=u(t),i=0,s=[];for(let e of o.bullets){let t=function(e,t){let r=new Set([...e].filter(e=>t.has(e))),n=new Set([...e,...t]);return n.size?r.size/n.size:0}(n,u(e));t>i&&(i=t,s=[e])}i<.28&&r.push({role:`${e.role} @ ${e.company}`,bullet:t,score:Number(i.toFixed(2)),backing:s})}}return{flags:r}}(n.original.experience||[],n.tailored.experience||[]);return a.NextResponse.json(o)}let h=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/honesty/route",pathname:"/api/honesty",filename:"route",bundlePath:"app/api/honesty/route"},resolvedPagePath:"/Users/yassinkhalil/Downloads/ai-resume-tailor_v2_full/app/api/honesty/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:v}=h,x="/api/honesty/route";function y(){return(0,s.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:g})}},74068:(e,t,r)=>{r.d(t,{iE:()=>a,rF:()=>l});var n=r(57147),o=r.n(n);let i="/tmp/ai-resume-tailor-config.json",s={rate:{ipPerMin:Number(process.env.RATE_IP_PER_MIN||30),sessionPerMin:Number(process.env.RATE_SESSION_PER_MIN||5)},invites:(process.env.INVITE_CODES||"").split(",").map(e=>e.trim()).filter(Boolean),openaiKey:void 0,pauseTailor:!1,pauseExport:!1};function a(){return s}function l(e){s={...s,...e,rate:{...s.rate,...e.rate||{}}},function(){try{o().writeFileSync(i,JSON.stringify(s,null,2))}catch{}}()}!function(){try{if(o().existsSync(i)){let e=o().readFileSync(i,"utf8"),t=JSON.parse(e);s={...s,...t}}}catch{}}()},32064:(e,t,r)=>{r.d(t,{M9:()=>c,d7:()=>d});var n=r(87070),o=r(74068);let i=new Map,s=new Map;function a(){return Date.now()}function l(e,t){let r=a();for(;e.length&&r-e[0]>t;)e.shift()}function u(e,t){let r=e.get(t)||[];return r.push(a()),e.set(t,r),r}function f(e,t){let r=(e.headers.get("cookie")||"").match(RegExp("(?:^|; )"+t+"=([^;]+)"));return r?decodeURIComponent(r[1]):null}function c(e){return f(e,"sid")||"anon"}function d(e){let t=(0,o.iE)();if(!function(e){let t=(0,o.iE)();if(!t.invites.length)return!0;let r=e.headers.get("x-invite-code")||"",n=f(e,"invite")||"",i=r||n;return!!i&&t.invites.includes(i)}(e))return{ok:!1,res:n.NextResponse.json({error:"Invite code required",code:"invite_required"},{status:403})};let r=(e.headers.get("x-forwarded-for")||"").split(",")[0].trim()||"0.0.0.0",d=c(e),p=u(i,r),h=u(s,d);return(l(p,6e4),l(h,6e4),function(e=6e4,t=5e3){let r=a();for(let[t,n]of i){for(;n.length&&r-n[0]>e;)n.shift();0===n.length&&i.delete(t)}for(let[t,n]of s){for(;n.length&&r-n[0]>e;)n.shift();0===n.length&&s.delete(t)}if(i.size>t){for(let e of i.keys())if(i.delete(e),i.size<=t)break}if(s.size>t){for(let e of s.keys())if(s.delete(e),s.size<=t)break}}(),p.length>t.rate.ipPerMin)?{ok:!1,res:n.NextResponse.json({error:"Rate limit exceeded (ip)",code:"rate_ip"},{status:429})}:h.length>t.rate.sessionPerMin?{ok:!1,res:n.NextResponse.json({error:"Rate limit exceeded (session)",code:"rate_session"},{status:429})}:{ok:!0}}},45647:(e,t,r)=>{r.d(t,{G:()=>a,e:()=>s});var n=r(9576);let o=new Map;function i(e=36e5){let t=Date.now();for(let[r,n]of o)t-n.createdAt>e&&o.delete(r)}function s(e,t,r,s){i();let a=(0,n.Z)(),l={id:a,createdAt:Date.now(),original:e,tailored:t,jdText:r,keywordStats:s};return o.set(a,l),l}function a(e){i();let t=o.get(e);return t?Date.now()-t.createdAt>36e5?(o.delete(e),null):t:null}},9576:(e,t,r)=>{r.d(t,{Z:()=>u});var n=r(6113),o=r.n(n);let i={randomUUID:o().randomUUID},s=new Uint8Array(256),a=s.length,l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));let u=function(e,t,r){if(i.randomUUID&&!t&&!e)return i.randomUUID();let n=(e=e||{}).random||(e.rng||function(){return a>s.length-16&&(o().randomFillSync(s),a=0),s.slice(a,a+=16)})();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return function(e,t=0){return l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]}(n)}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,972],()=>r(78160));module.exports=n})();