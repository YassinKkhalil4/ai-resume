"use strict";(()=>{var e={};e.id=306,e.ids=[306],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},57147:e=>{e.exports=require("fs")},78160:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>y,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>h,serverHooks:()=>v,staticGenerationAsyncStorage:()=>g});var r={};n.r(r),n.d(r,{POST:()=>p,dynamic:()=>c,runtime:()=>d});var o=n(49303),i=n(88716),s=n(60670),a=n(87070),l=n(45647);function u(e){return new Set((e.toLowerCase().match(/[a-z0-9\-\+\.]{3,}/g)||[]).filter(e=>!["and","the","for","with","from","this","that"].includes(e)))}var f=n(32064);let c="force-dynamic",d="nodejs";async function p(e){if(!process.env.OPENAI_API_KEY)return a.NextResponse.json({code:"no_openai_key",message:"Server not configured"},{status:503});let t=(0,f.d7)(e);if(!t.ok)return t.res;let{session_id:n}=await e.json()||{},r=(0,l.G)(n||"");if(!r)return a.NextResponse.json({code:"session_not_found",message:"Session not found"},{status:404});let o=function(e,t){let n=[],r=new Map;for(let t of e)r.set(t.company+"|"+t.role,t);for(let e of t){let t=e.company+"|"+e.role,o=r.get(t);if(o)for(let t of e.bullets){let r=u(t),i=0,s=[];for(let e of o.bullets){let t=function(e,t){let n=new Set([...e].filter(e=>t.has(e))),r=new Set([...e,...t]);return r.size?n.size/r.size:0}(r,u(e));t>i&&(i=t,s=[e])}i<.28&&n.push({role:`${e.role} @ ${e.company}`,bullet:t,score:Number(i.toFixed(2)),backing:s})}}return{flags:n}}(r.original.experience||[],r.tailored.experience||[]);return a.NextResponse.json(o)}let h=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/honesty/route",pathname:"/api/honesty",filename:"route",bundlePath:"app/api/honesty/route"},resolvedPagePath:"/Users/yassinkhalil/Downloads/ai-resume-tailor_v2_full/app/api/honesty/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:v}=h,y="/api/honesty/route";function x(){return(0,s.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:g})}},74068:(e,t,n)=>{n.d(t,{iE:()=>a,rF:()=>l});var r=n(57147),o=n.n(r);let i="/tmp/ai-resume-tailor-config.json",s={rate:{ipPerMin:Number(process.env.RATE_IP_PER_MIN||30),sessionPerMin:Number(process.env.RATE_SESSION_PER_MIN||5)},invites:(process.env.INVITE_CODES||"").split(",").map(e=>e.trim()).filter(Boolean),openaiKey:void 0,pauseTailor:!1,pauseExport:!1};function a(){return s}function l(e){s={...s,...e,rate:{...s.rate,...e.rate||{}}},function(){try{o().writeFileSync(i,JSON.stringify(s,null,2))}catch{}}()}!function(){try{if(o().existsSync(i)){let e=o().readFileSync(i,"utf8"),t=JSON.parse(e);s={...s,...t}}}catch{}}()},32064:(e,t,n)=>{n.d(t,{M9:()=>c,d7:()=>d});var r=n(87070),o=n(74068);let i=new Map,s=new Map;function a(){return Date.now()}function l(e,t){let n=a();for(;e.length&&n-e[0]>t;)e.shift()}function u(e,t){let n=e.get(t)||[];return n.push(a()),e.set(t,n),n}function f(e,t){let n=(e.headers.get("cookie")||"").match(RegExp("(?:^|; )"+t+"=([^;]+)"));return n?decodeURIComponent(n[1]):null}function c(e){return f(e,"sid")||"anon"}function d(e){let t=(0,o.iE)();if(!function(e){let t=(0,o.iE)();if(!t.invites.length)return!0;let n=e.headers.get("x-invite-code")||"",r=f(e,"invite")||"",i=n||r;return!!i&&t.invites.includes(i)}(e))return{ok:!1,res:r.NextResponse.json({code:"invite_required",message:"Invite code required"},{status:403})};let n=(e.headers.get("x-forwarded-for")||"").split(",")[0].trim()||"0.0.0.0",d=c(e),p=u(i,n),h=u(s,d);return(l(p,6e4),l(h,6e4),function(e=6e4,t=5e3){let n=a();for(let[t,r]of i){for(;r.length&&n-r[0]>e;)r.shift();0===r.length&&i.delete(t)}for(let[t,r]of s){for(;r.length&&n-r[0]>e;)r.shift();0===r.length&&s.delete(t)}if(i.size>t){for(let e of i.keys())if(i.delete(e),i.size<=t)break}if(s.size>t){for(let e of s.keys())if(s.delete(e),s.size<=t)break}}(),p.length>t.rate.ipPerMin||h.length>t.rate.sessionPerMin)?{ok:!1,res:r.NextResponse.json({code:"rate_limited",message:"Too many requests"},{status:429})}:{ok:!0}}},45647:(e,t,n)=>{n.d(t,{G:()=>a,e:()=>s});var r=n(9576);let o=new Map;function i(e=36e5){let t=Date.now();for(let[n,r]of o)t-r.createdAt>e&&o.delete(n)}function s(e,t,n,s){i();let a=(0,r.Z)(),l={id:a,createdAt:Date.now(),original:e,tailored:t,jdText:n,keywordStats:s};return o.set(a,l),l}function a(e){i();let t=o.get(e);return t?Date.now()-t.createdAt>36e5?(o.delete(e),null):t:null}},9576:(e,t,n)=>{n.d(t,{Z:()=>u});var r=n(6113),o=n.n(r);let i={randomUUID:o().randomUUID},s=new Uint8Array(256),a=s.length,l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));let u=function(e,t,n){if(i.randomUUID&&!t&&!e)return i.randomUUID();let r=(e=e||{}).random||(e.rng||function(){return a>s.length-16&&(o().randomFillSync(s),a=0),s.slice(a,a+=16)})();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]}(r)}}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[948,972],()=>n(78160));module.exports=r})();