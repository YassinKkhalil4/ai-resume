"use strict";(()=>{var e={};e.id=647,e.ids=[647],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},87561:e=>{e.exports=require("node:fs")},84492:e=>{e.exports=require("node:stream")},72477:e=>{e.exports=require("node:stream/web")},71017:e=>{e.exports=require("path")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},71267:e=>{e.exports=require("worker_threads")},59796:e=>{e.exports=require("zlib")},39311:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>k,patchFetch:()=>v,requestAsyncStorage:()=>f,routeModule:()=>h,serverHooks:()=>_,staticGenerationAsyncStorage:()=>y});var s={};t.r(s),t.d(s,{POST:()=>m,dynamic:()=>x,maxDuration:()=>g,runtime:()=>d});var o=t(49303),n=t(88716),i=t(60670),a=t(87070),c=t(32064),l=t(45647),p=t(69836),u=t(21614);let d="nodejs",x="force-dynamic",g=30;async function m(e){console.log("Process Experience API called:",{method:e.method,url:e.url,timestamp:new Date().toISOString()});try{let r,t;let s=(0,c.d7)(e);if(!s.ok)return s.res;let{experienceText:o,sessionId:n,jdText:i,tone:d="professional"}=await e.json();if(!o||!i)return a.NextResponse.json({code:"invalid_input",message:"Missing experience text or job description"},{status:400});console.log("Processing experience text:",{experienceTextLength:o.length,hasSessionId:!!n,jdTextLength:i.length,tone:d}),console.log("Extracting experience from free text...");let x=await (0,p._U)(o);if(0===x.length)return a.NextResponse.json({code:"no_experience_extracted",message:"Could not extract structured experience from the provided text"},{status:400});console.log("Extracted experience:",{experienceCount:x.length,totalBullets:x.reduce((e,r)=>e+r.bullets.length,0)});let g=null;n&&(g=(0,l.Gg)(n)),r=g?{...g.original,experience:x}:{summary:"Professional with relevant experience",skills:[],experience:x,education:[],certifications:[]},console.log("Created resume structure:",{hasSummary:!!r.summary,skillsCount:r.skills.length,experienceCount:r.experience.length,educationCount:r.education.length,certificationsCount:r.certifications.length});let m=(0,u.F)(r,i);console.log("ATS check completed:",{coverage:m.coverage,matchedKeywords:m.matched?.length||0,missingKeywords:m.missing?.length||0}),console.log("Starting AI tailoring...");let{tailored:h,tokens:f}=await (0,p.yC)(r,i,d);if(console.log("AI tailoring completed:",{hasSummary:!!h.summary,skillsCount:h.skills_section?.length||0,experienceCount:h.experience?.length||0,tokensUsed:f}),!(t=g?(0,l.CT)(n,{original:r,tailored:h,jdText:i,keywordStats:m}):(0,l.ed)(r,h,i,m)))return a.NextResponse.json({code:"session_error",message:"Failed to create or update session"},{status:500});return console.log("Experience processing completed successfully:",{sessionId:t.id,extractedExperienceCount:x.length}),a.NextResponse.json({success:!0,session_id:t.id,session_version:t.version,original_sections_json:r,preview_sections_json:h,keyword_stats:m,tokens_used:f,extracted_experience_count:x.length,message:"Experience processed and resume tailored successfully"})}catch(e){return console.error("Process experience error:",e),console.error("Error stack:",e instanceof Error?e.stack:"No stack trace"),a.NextResponse.json({code:"processing_failed",message:"Failed to process experience text",details:void 0,timestamp:new Date().toISOString()},{status:500})}}let h=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/process-experience/route",pathname:"/api/process-experience",filename:"route",bundlePath:"app/api/process-experience/route"},resolvedPagePath:"/Users/yassinkhalil/Downloads/ai-resume-tailor_v2_full/app/api/process-experience/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:y,serverHooks:_}=h,k="/api/process-experience/route";function v(){return(0,i.patchFetch)({serverHooks:_,staticGenerationAsyncStorage:y})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[948,972,844,542],()=>t(39311));module.exports=s})();