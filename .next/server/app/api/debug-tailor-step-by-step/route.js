"use strict";(()=>{var e={};e.id=399,e.ids=[399],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},87561:e=>{e.exports=require("node:fs")},84492:e=>{e.exports=require("node:stream")},72477:e=>{e.exports=require("node:stream/web")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},71267:e=>{e.exports=require("worker_threads")},59796:e=>{e.exports=require("zlib")},703:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>f,patchFetch:()=>k,requestAsyncStorage:()=>S,routeModule:()=>m,serverHooks:()=>y,staticGenerationAsyncStorage:()=>h});var r={};s.r(r),s.d(r,{POST:()=>x});var o=s(49303),n=s(88716),i=s(60670),a=s(87070),l=s(48179),p=s(85892),u=s(21614),c=s(45647),d=s(32064),g=s(77462);async function x(e){try{console.log("Debug Tailor Step-by-Step API called"),console.log("Step 1: Guard check...");let t=(0,d.d7)(e);if(!t.ok)return console.log("Guard check failed:",t.res),t.res;console.log("Step 1: Guard check passed"),console.log("Step 2: Parse form data...");let s=await e.formData(),r=s.get("resume_file"),o=s.get("jd_text")?.toString()||"",n=s.get("tone")?.toString()||"professional";if(!r)return a.NextResponse.json({code:"missing_resume",message:"Missing resume input"},{status:400});if(!o)return a.NextResponse.json({code:"missing_jd",message:"Missing jd_text"},{status:400});console.log("Step 2: Form data parsed successfully"),console.log("Step 3: Extract text from file...");let i=await (0,l.H)(r),x=i.text,m=i.ext;console.log("Step 3: Text extracted successfully",{textLength:x.length,extension:m}),console.log("Step 4: Parse resume...");let S=(0,l.r)(x);console.log("Step 4: Resume parsed successfully",{hasSummary:!!S.summary,skillsCount:S.skills?.length||0,experienceCount:S.experience?.length||0}),console.log("Step 5: Validate parsing...");let h=(0,g.CQ)(S);if(console.log("Step 5: Validation completed",h),console.log("Step 6: Check experience banner..."),(0,g.VV)(h))return console.log("Step 6: Should show experience banner"),a.NextResponse.json({code:"missing_experience",message:"No work experience detected in your resume",validation:h,original_sections_json:S},{status:422});console.log("Step 6: No experience banner needed"),console.log("Step 7: AI tailoring...");let{tailored:y,tokens:f}=await (0,p.yC)(S,o,n);console.log("Step 7: AI tailoring completed",{hasSummary:!!y.summary,skillsCount:y.skills_section?.length||0,experienceCount:y.experience?.length||0,tokens:f}),console.log("Step 8: ATS check...");let k=(0,u.F)(S,o);console.log("Step 8: ATS check completed",{coverage:k.coverage,matchedKeywords:k.matched?.length||0}),console.log("Step 9: Create session...");let b=(0,c.ed)(S,y,o,k);return console.log("Step 9: Session created successfully",{sessionId:b.id}),a.NextResponse.json({status:"success",message:"All steps completed successfully",session_id:b.id,steps_completed:["Guard check","Form data parsing","Text extraction","Resume parsing","Validation","Experience banner check","AI tailoring","ATS check","Session creation"],data:{original:S,tailored:y,validation:h,keywordStats:k,tokens:f}})}catch(e){return console.error("Debug Tailor Step-by-Step API error:",e),a.NextResponse.json({status:"error",error:e.message,stack:e.stack,step:"Unknown"},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/debug-tailor-step-by-step/route",pathname:"/api/debug-tailor-step-by-step",filename:"route",bundlePath:"app/api/debug-tailor-step-by-step/route"},resolvedPagePath:"/Users/yassinkhalil/Downloads/ai-resume-tailor_v2_full/app/api/debug-tailor-step-by-step/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:S,staticGenerationAsyncStorage:h,serverHooks:y}=m,f="/api/debug-tailor-step-by-step/route";function k(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:h})}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,972,214,969,882,699,440,175],()=>s(703));module.exports=r})();